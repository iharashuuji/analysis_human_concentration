import streamlit as st

st.set_page_config(
    page_title="世界モデル 異常検知",
    page_icon="🧠",
    layout="wide"
)

st.title("🧠 世界モデル（VAE+RNN）による異常検知")

st.markdown("""
このアプリは、「正常な（集中した）」状態の表情変化パターン（DAiSEE: Engage=3）のみを学習した
世界モデル（V: VAE + M: RNN）を使用しています。

**👈 サイドバーから「Analyze Video」を選択してください。**

### 機能
- **観測 (V):** `VAE` が動画の各フレームを「表情の特徴（$z$）」に圧縮します。
- **予測 (M):** `RNN` が「"正常"な表情の"次"の動き（$\hat{z}$）」を予測します。
- **異常検知:** 「実際の動き（$z$）」と「予測（$\hat{z}$）」の誤差（MSE）を**異常スコア**としてグラフ化します。

"正常"（集中）から逸脱した「あくび」や「よそ見」などの"異常"な動きが入力されると、
モデルは予測に失敗し、異常スコアがスパイクします。
""")